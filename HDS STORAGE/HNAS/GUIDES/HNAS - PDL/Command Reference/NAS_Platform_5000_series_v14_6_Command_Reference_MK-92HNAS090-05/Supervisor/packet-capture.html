<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>packet-capture</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
  <!--
  @page { size: 8.27in 11.69in }
  H1  { font-family: "Verdana", sans-serif }
  H2  { font-family: "Verdana", sans-serif }
  H3  { font-family: "Verdana", sans-serif }
  H4  { font-family: "Verdana", sans-serif }
  P   { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  PRE { font-family: "Courier", monospace;  font-size: 12pt; margin-left: 40px; }
  DT  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  LI  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  -->
  </style>

</head>
<body style="background-color: white">
<!--Start header -->
<!-- html created: 2023-03-07 10:21:49 +0000 oemId: 1 -->
<h1>packet-capture</h1>
<p>captures packets</p>
<h1>Syntax</h1>
<pre>packet-capture [--start [--snaplen ##] [--filter &#39;pcap filter&#39;] &lt;interface name&gt;]
[--stop &lt;interface name&gt;]
[--heritage old|recent]
Alias:       pcap
</pre>

<h1>Description</h1>
<p>The packet-capture command provides the ability to capture packets from a given interface, and store the capture in a file you specify. The file containing the captured packets can then be downloaded for offline analysis with tools such as wireshark, tshark and tcpdump.</p>
<p>To ensure server stability, the file containing the capture is limited to a maximum of 32MB or 15,000 frames (whichever is reached first), and the file containing the captured packets should be deleted as soon as possible.</p>
<p><strong>Warning:</strong> Server performance will be severely degraded while capturing packets, because hardware acceleration is disabled and server memory is being consumed while packets are being captured.</p>
<p>Options:</p>
<dl>
<dt><strong>--start [--filter tcpdump-filter] [--snaplen ##] &lt;interface&gt;</strong></dt>
<dd><p>The --start option starts capturing on a given interface. The --snaplen option defines the amount of a packet to capture. The --filter provides the ability to filter packets on capture. The filter should conform to the syntax used for tcpdump and wireshark capture filters. The default value for --snaplen is 65535. To capture traffic from any public interface, use the special interface name "any".</p></dd>
<dt><strong>--stop &lt;interface&gt;</strong></dt>
<dd><p>The --stop option stops capturing on a given interface and saves the capture in an ssfs file called tmp.</p></dd>
<dt><strong>--heritage old|recent</strong></dt>
<dd><p>If packets need to be discarded due to resource issues, then --heritage decides which ones to keep (old or recent ones). The default is recent.</p></dd>
</dl>
<h1>Examples</h1>
<p>To start a packet capture on interface ag1:</p>
<pre>packet-capture --start ag1
</pre>
<p></p>
<p>To stop and save a capture on interface ag1:</p>
<pre>packet-capture --stop ag1
</pre>
<p></p>
<p>To start a packet capture on interface ag1, capturing only ICMP and ARP traffic:</p>
<pre>packet-capture --start --filter "icmp or arp" ag1
</pre>
<p></p>
<p>To start a packet capture on all public interfaces, capturing traffic to and from 10.1.1.83:</p>
<pre>packet-capture --start --filter "host 10.1.1.83" any
</pre>
<p></p>
<p>To start a packet capture on all public interfaces:</p>
<pre>packet-capture --start any
</pre>
<p></p>
<p>To stop a packet capture on all public interfaces:</p>
<pre>packet-capture --stop any
</pre>
<p></p>
<p>To retrieve the capture from server 10.1.26.64 into a local file called /tmp/asc.cap so it can be analyzed by wireshark, tshark or tcpdump:</p>
<pre>ssc 10.1.26.64 ssget tmp /tmp/asc.cap
</pre>
<p></p>
<p>To mail a capture to someone:</p>
<pre>nail -n -a tmp -s "icmp packet capture" myname@example.com
</pre>
<p></p>
<p>To remove the capture file and free up memory:</p>
<pre>ssrm tmp
</pre>
<p></p>
<h1>Applies To</h1>
<p>Cluster node</p>
<h1>See Also</h1>
<p><a href="../Supervisor/nail.html">nail</a> <a href="../Topic/ssfs.html">ssfs</a> <a href="../Supervisor/ssrm.html">ssrm</a></p>
<h1>Privilege Level</h1>
<p>Supervisor</p>
<blockquote></blockquote>
<!--End footer-->
</body>
</html>
