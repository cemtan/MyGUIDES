<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>connection</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
  <!--
  @page { size: 8.27in 11.69in }
  H1  { font-family: "Verdana", sans-serif }
  H2  { font-family: "Verdana", sans-serif }
  H3  { font-family: "Verdana", sans-serif }
  H4  { font-family: "Verdana", sans-serif }
  P   { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  PRE { font-family: "Courier", monospace;  font-size: 12pt; margin-left: 40px; }
  DT  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  LI  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  -->
  </style>

</head>
<body style="background-color: white">
<!--Start header -->
<!-- html created: 2023-03-07 12:50:50 +0000 oemId: 1 -->
<h1>connection</h1>
<p>Show/delete/reset stats for network protocol connections</p>
<h1>Syntax</h1>
<pre>connection [-v | -s | -r | --delete] [-i &lt;ip address&gt;] [-c &lt;connection id&gt;] [-n &lt;name&gt; | all]
</pre>

<h1>Description</h1>
<p>The connection command manages connection-oriented file service protocol connections. Considerable detail is produced for SMB connections, somewhat less for TCP-based NFS connections.</p>
<p>Usage:</p>
<p>connection [OPTIONS]</p>
<p>Options are:</p>
<dl>
<dt><strong>-v, --verbose</strong></dt>
<dd><p>increases the verbosity, dumping the credentials for each selected SMB connection</p></dd>
<dt><strong>-s, --summary</strong></dt>
<dd><p>summarizes the output, just indicating how much activity there has been on each selected connection</p></dd>
<dt><strong>-r, --reset</strong></dt>
<dd><p>resets the request count for each selected connection (overrides a show stats request)</p></dd>
<dt><strong>--delete</strong></dt>
<dd><p>forcibly closes each selected connection (overrides all other requests)</p></dd>
<dt><strong>-c, --connectionid &lt;connection id&gt;</strong></dt>
<dd><p>restricts the connections on which to operate to the specified connection identifier</p></dd>
<dt><strong>-i, --ipaddr &lt;ip address&gt;</strong></dt>
<dd><p>restricts the connections on which to operate to the specified peer IP address. IPv4 or IPv6 addresses can be used.</p></dd>
<dt><strong>-n, --name &lt;name&gt;</strong></dt>
<dd><p>restricts the connections on which to operate to the specified service name, for example SMB, NFS or iSCSI.</p></dd>
<dd><p>Valid service names are: CIFS, SMB, iSCSI, iSNS, VAAI, NFS, Mountd, Statd, Lockd, PortMapper, Rquota, 'Object Replication', and DCE/RPC.</p></dd>
<dd><p>The SMB connections can be more finely filtered using SMB1, SMB2, or SMB3. Similarly, the NFS connections can be more finely filtered using NFS2, NFS3 or NFS4.</p></dd>
<dt><strong>all</strong></dt>
<dd><p>specifies that all connections are to be operated on (overrides any specified restrictions)</p></dd>
</dl>
<p>The summary information for a SMB1 connection includes some information about the protocol version, a count of the number of requests serviced on the connection since it was set up or since the counter was reset with the --reset option explained above and counts of the number of currently open files and in-progress directory "searches".</p>
<h1>Examples</h1>
<pre>$ connection --verbose all
SMB1 Connection: 714 evs=1 {peer=10.72.42.77:43186, local=172.27.5.92:445} 4 requests, winnt, nt 1, 1 files, 0 searches, file pointers are not valid.
  Client OS : protest
  Client LAN Manager : protest
  UID: 1 - anonymous
    TID: 1 - cs1
    Rights: 0x21f01ff = FullControl | MaximumAllowedRight
    File umask: [not set]
    Directory umask: [not set]
TDP(yes)      FID: 1 TDP(no)
      Path: \smb1
      Length: 0 B
      Oplock(0x00007F735961D350) level = None
      Access: 0x7 = Read | Write | Delete, Share: 0x7 = Read | Write | Delete
      Changes to dispatch on close: 0x0
</pre>
<p></p>
<pre>SMB2 Connection: 715 evs=1 {peer=10.72.42.77:43187, local=172.27.5.92:445} 4 requests (SMB:2.0) 1 files
Message window: [5, 51): 0000000000000000000000000000000000000000000000
Session id: 0x1020000000000002 handle:0x0000000000002 evs:1 cluster node:1 1 open files Session is: Valid
      user (and defaultOwner)             : Unix: nobody (65534), NT: NT AUTHORITY\Anonymous Logon (S-1-5-7), NFSv4: ANONYMOUS@
      primaryGroup (and defaultGroup)     : Unix: nogroup (65534), NT: NT AUTHORITY\Anonymous Logon (S-1-5-7), NFSv4: ANONYMOUS@
      enabled features                    : none
      disabled features                   : authenticated, administrator, backup operator, audit service operator, root user, root bypass, access bypass, syslock bypass, virus scanner, owner read/write bypass, owner granted unix owner rights bypass, protected named streams bypass, private named streams bypass, WORM delete bypass
      rightsGrantedThroughSecurityModel   : 0x0
      rightsGrantedThroughGroupMembership : 0x0
      externallyConferredSIDs             :
      otherConferredSIDs                  :
        SID : Everyone (S-1-1-0), Attributes : 4
        SID : NT AUTHORITY\NETWORK (S-1-5-2), Attributes : 4
        SID : NFSv4 group\NETWORK@ (S-1-79-8-1465140558-1078678095), Attributes : 4
        SID : NFSv4 group\EVERYONE@ (S-1-79-9-1380275781-1162760025-64), Attributes : 4
Tree id: 1
      Tdp: programmed (Tree connect key: {sessionId=1161928703861587970, treeId=1})
      Share name: cs1
      Rights: 0x21f01ff = FullControl | MaximumAllowedRight
File id: vol: 0x0000000000000001 dur: 0x000600000000000b (dev: 0x0006)  TDP: no
      Path: \smb2
      Length: 0 B
      Oplock(0x00007F735961DDB8) level = None
      Access: 0x7 = Read | Write | Delete, Share: 0x7 = Read | Write | Delete
      Changes to dispatch on close: 0x0
      OplockBreaker:
        this: 0x00007F737B39C100
        session: 1161928703861587970
        fileid: vol: 0x0000000000000001 dur: 0x000600000000000b (dev: 0x0006)
        oplock ID: {Client GUID: Empty; Oplock Key: Empty}
        level: 0
        breaking to 0
        history: 0x8005 = Opening | OpenedOK | Connected
        notifier: 0x0000000000000000
        do fsw detach 1
        failed to open 0
        breaking 0
        ack required 0
</pre>
<p></p>
<pre>SMB3 Connection: 716 evs=1 {peer=10.72.42.77:43188, local=172.27.5.92:445} 4 requests (SMB:3.0) 1 files
Message window: [5, 51): 0000000000000000000000000000000000000000000000
Session id: 0x1020000000000003 handle:0x0000000000003 evs:1 cluster node:1 1 open files Session is: Valid
      user (and defaultOwner)             : Unix: nobody (65534), NT: NT AUTHORITY\Anonymous Logon (S-1-5-7), NFSv4: ANONYMOUS@
      primaryGroup (and defaultGroup)     : Unix: nogroup (65534), NT: NT AUTHORITY\Anonymous Logon (S-1-5-7), NFSv4: ANONYMOUS@
      enabled features                    : none
      disabled features                   : authenticated, administrator, backup operator, audit service operator, root user, root bypass, access bypass, syslock bypass, virus scanner, owner read/write bypass, owner granted unix owner rights bypass, protected named streams bypass, private named streams bypass, WORM delete bypass
      rightsGrantedThroughSecurityModel   : 0x0
      rightsGrantedThroughGroupMembership : 0x0
      externallyConferredSIDs             :
      otherConferredSIDs                  :
        SID : Everyone (S-1-1-0), Attributes : 4
        SID : NT AUTHORITY\NETWORK (S-1-5-2), Attributes : 4
        SID : NFSv4 group\NETWORK@ (S-1-79-8-1465140558-1078678095), Attributes : 4
        SID : NFSv4 group\EVERYONE@ (S-1-79-9-1380275781-1162760025-64), Attributes : 4
Tree id: 1
      Tdp: programmed (Tree connect key: {sessionId=1161928703861587971, treeId=1})
      Share name: cs1
      Rights: 0x21f01ff = FullControl | MaximumAllowedRight
File id: vol: 0x0000000000000001 dur: 0x000600000000000c (dev: 0x0006)  TDP: no
      Path: \smb3
      Length: 0 B
      Oplock(0x00007F735961D818) level = None
      Access: 0x7 = Read | Write | Delete, Share: 0x7 = Read | Write | Delete
      Changes to dispatch on close: 0x0
      OplockBreaker:
        this: 0x00007F737B39C000
        session: 1161928703861587971
        fileid: vol: 0x0000000000000001 dur: 0x000600000000000c (dev: 0x0006)
        oplock ID: {Client GUID: Empty; Oplock Key: Empty}
        level: 0
        breaking to 0
        history: 0x8005 = Opening | OpenedOK | Connected
        notifier: 0x0000000000000000
        do fsw detach 1
        failed to open 0
        breaking 0
        ack required 0
</pre>
<p></p>
<pre>PortMapper Connection: 717 evs=1 {peer=10.72.42.77:37570, local=172.27.5.92:111} 1 request
Program version: 2
Authentication flavor: AuthNull
</pre>
<p></p>
<pre>NFS Connection: 718 evs=1 {peer=10.72.42.77:44972, local=172.27.5.92:2049} 1 request
Program version: 3
Authentication flavor: AuthUnix
$
</pre>
<p></p>
<pre>$ connection --delete all
$
</pre>
<p></p>
<pre>$ connection --reset --name cifs
$
</pre>
<p></p>
<pre>$ connection -c 764
NFS Connection: 764 evs=1 {peer=10.72.42.77:44985, local=172.27.5.92:2049} 1 request
Program version: 3
Authentication flavor: AuthUnix
$
</pre>
<p></p>
<pre>$ connection -s -i 10.72.42.74
SMB2 Connection: 769 evs=1 {peer=10.72.42.74:43200, local=172.27.5.92:445} 4 requests (SMB:2.0) 1 files
$
</pre>
<p></p>
<pre>$ connection -s -i fdca:f995:220a::1:10
SMB3 Connection: 266 evs=1 {peer=fdca:f995:220a::1:10:36336, local=fdca:f995:220a:480:1:1:24:0:445} 4 requests (SMB:3.0) 1 files
$
</pre>
<p></p>
<pre>$ connection -s -i fdca:f995:220a:0:e4ad:93aa:6f32:13fa
iSCSI Connection: 268 evs=1 ( {peer=fdca:f995:220a:0:e4ad:93aa:6f32:13fa:53493, local=fdca:f995:220a:480:1:1:24:0:445})
$
</pre>
<p></p>
<pre>$ connection -s all
SMB1 Connection: 257 evs=1 {peer=10.72.42.77:45355, local=172.27.5.42:445} 4 requests, winnt, nt 1, 1 files, 0 searches, file pointers are not valid.
SMB2 Connection: 258 evs=1 {peer=10.72.42.77:45356, local=172.27.5.42:445} 4 requests (SMB:2.0) 1 files
SMB3 Connection: 259 evs=1 {peer=10.72.42.77:45357, local=172.27.5.42:445} 4 requests (SMB:3.0) 1 files
NFS Connection: 261 evs=1 {peer=10.72.42.77:40633, local=172.27.5.42:2049} 1 request
PortMapper Connection: 260 evs=1 {peer=10.72.42.77:51991, local=172.27.5.42:111} 1 request
$
</pre>
<p></p>
<h1>Applies To</h1>
<p>Cluster node</p>
<h1>See Also</h1>
<p><a href="../Supervisor/credentials-list.html">credentials-list</a> <a href="../Supervisor/credentials-reassess.html">credentials-reassess</a> <a href="../Supervisor/give-domain-administrators-local-administrator-rights.html">give-domain-administrators-local-administrator-rights</a> <a href="../Supervisor/local-group-disable-saving.html">local-group-disable-saving</a> <a href="../Supervisor/local-group-save.html">local-group-save</a> <a href="../User/localgroup.html">localgroup</a> <a href="../Supervisor/primary-group-delete.html">primary-group-delete</a> <a href="../Supervisor/primary-group-delete-all.html">primary-group-delete-all</a> <a href="../Supervisor/primary-group-disable-saving.html">primary-group-disable-saving</a> <a href="../User/primary-group-list.html">primary-group-list</a> <a href="../Supervisor/primary-group-save.html">primary-group-save</a> <a href="../Supervisor/primary-group-set.html">primary-group-set</a> <a href="../Supervisor/smb2-session-connection-list.html">smb2-session-connection-list</a></p>
<h1>Privilege Level</h1>
<p>Supervisor</p>
<blockquote></blockquote>
<!--End footer-->
</body>
</html>
