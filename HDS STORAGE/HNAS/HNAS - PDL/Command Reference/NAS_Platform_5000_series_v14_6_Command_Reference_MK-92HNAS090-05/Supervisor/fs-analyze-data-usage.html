<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>fs-analyze-data-usage</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
  <!--
  @page { size: 8.27in 11.69in }
  H1  { font-family: "Verdana", sans-serif }
  H2  { font-family: "Verdana", sans-serif }
  H3  { font-family: "Verdana", sans-serif }
  H4  { font-family: "Verdana", sans-serif }
  P   { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  PRE { font-family: "Courier", monospace;  font-size: 12pt; margin-left: 40px; }
  DT  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  LI  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  -->
  </style>

</head>
<body style="background-color: white">
<!--Start header -->
<!-- html created: 2023-03-07 10:21:49 +0000 oemId: 1 -->
<h1>fs-analyze-data-usage</h1>
<p>Report on the type of data space is used for on a given file system</p>
<h1>Syntax</h1>
<pre>fs-analyze-data-usage  [-a] -f &lt;file system&gt;
</pre>

<h1>Description</h1>
<p>The primary purpose of fs-analyze-data-usage is to show what proportion of used space on a file system is assigned to metadata, and what proportion is used for user data. metadata is internal data that is used by the file system to, amongst other things, organize the user data. metadata is not seen by clients. metadata is generally accessed much more frequently than user data, and, if MTFS is enabled, the file system will attempt to write metadata to fast tier0 storage.</p>
<p>Example output:</p>
<pre>User data: 297 MB (49% of used space. 2% of 10.1 GB file system)
 Metadata including leaf onodes: 309 MB (51% of used space. 3% of 10.1 GB file system)
 Metadata excluding leaf onodes: 290 MB (47% of used space. 2% of 10.1 GB file system)
 Total number of Files: 8581. Total number Hard Links: 9887
 Number of Software Metadata Objects: 7680
</pre>
<p></p>
<pre>File size statistics:
  Samples=    8581  Total=257 MB (269726718 B)  Min=   0 B  Av=30.7 KB (31433 B)  Max=205 KB (209622 B)
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>       3863|#
       1931|#    #
        965|#    ##
        482|#   ###
        241|#  ####
        120|# ######
         60|# ######
         30|########
         15|########
          7|########
          3|########
          1|########
           +--------------------------------
            |   |   |   |   |   |   |   |
           1KB 16 256  4MB 64  1GB 16 256
</pre>
<p></p>
<pre>
</pre>
<p></p>
<pre>Directory size statistics:
  Samples=    1112  Total=4.22 MB (4423680 B)  Min=2 KB (2048 B)  Av=3.88 KB (3978 B)  Max=18 KB (18432 B)
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>        557| #
        278| ##
        139| ##
         69| ###
         34| ###
         17| ###
          8| ###
          4| ####
          2| ####
          1| ####
           +--------------------------------
            |   |   |   |   |   |   |   |
           1KB 16 256  4MB 64  1GB 16 256
</pre>
<p></p>
<pre>
</pre>
<p></p>
<pre>WTREE size statistics:
  Samples=     275  Total=552 KB (565248 B)  Min=2 KB (2048 B)  Av=2.01 KB (2055 B)  Max=4 KB (4096 B)
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>Security Descriptor size statistics:
  Samples=    7377  Total=735 KB (752472 B)  Min=  80 B  Av= 102 B  Max= 176 B
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>Software Metadata size statistics:
  Samples=    7680  Total=470 KB (481216 B)  Min=   0 B  Av=  62 B  Max=1.05 KB (1072 B)
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>Named Stream size statistics:
  Samples=    4092  Total=27.9 MB (29273163 B)  Min=   0 B  Av=6.99 KB (7153 B)  Max=167 KB (171132 B)
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>Link Tracker size statistics:
  Samples=    1131  Total=38.1 KB (38992 B)  Min=  32 B  Av=  34 B  Max=  80 B
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>Freed Blocks size statistics:
  Samples=     128  Total=274 KB (280576 B)  Min=   0 B  Av=2.14 KB (2192 B)  Max=10 KB (10240 B)
  Last reset 3.23 s ago
</pre>
<p></p>
<pre>Format File size statistics:
  Samples=      11  Total=29.2 MB (30639220 B)  Min=   0 B  Av=2.66 MB (2785383 B)  Max=26.4 MB (27656192 B)
  Last reset 3.23 s ago
</pre>
<p></p>
<p>The most useful lines of output are the first three lines. The first line shows the usage for user data. The second and third lines shows the metadata usage both with and without Leaf Onodes. Leaf Onode metadata, although common, is typically not accessed as frequently as other types of metadata. Therefore there is an option with MTFS to write Leaf Onodes to either tier0 or tier1 storage. For example, if tier0 storage is at a premium then it may be preferable to exclude Leaf Onodes from tier0 storage. On the other hand, if that is not the case, and the average file size is particularly large, it may be desirable to include Leaf Onode in tier0.</p>
<p>If the file system is in "true-sparse-files" mode, an additional row of sparse block usage is shown. If this mode is not enabled, sparse usage is included in the user data usage row.</p>
<p>For the purposes of determining tiered storage requirements, the more user data that is present on the target file system, the more meaningful the analysis will be. For example, there is no benefit to running this tool on a file system that is less than 1% full.</p>
<p>fs-analyze-data-usage is an asynchronous utility. The WFS-2 file system must be mounted. It does not invoke any file system locks.</p>
<p>Results may be viewed in the dynamic log.</p>
<p>Options:</p>
<dl>
<dt><strong>-a</strong></dt>
<dd><p>Abort the currently running instance of this utility.</p></dd>
</dl>
<h1>Applies To</h1>
<p>EVS</p>
<h1>See Also</h1>
<p><a href="../Supervisor/dynamic-log-dump.html">dynamic-log-dump</a> <a href="../Supervisor/true-sparse-files.html">true-sparse-files</a> <a href="../Supervisor/utility-progress.html">utility-progress</a></p>
<h1>Privilege Level</h1>
<p>Supervisor</p>
<blockquote></blockquote>
<!--End footer-->
</body>
</html>
