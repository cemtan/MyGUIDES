<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>external-migration</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
  <!--
  @page { size: 8.27in 11.69in }
  H1  { font-family: "Verdana", sans-serif }
  H2  { font-family: "Verdana", sans-serif }
  H3  { font-family: "Verdana", sans-serif }
  H4  { font-family: "Verdana", sans-serif }
  P   { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  PRE { font-family: "Courier", monospace;  font-size: 12pt; margin-left: 40px; }
  DT  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  LI  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  -->
  </style>

</head>
<body style="background-color: white">
<!--Start header -->
<!-- html created: 2023-03-05 07:29:14 +0000 oemId: 1 -->
<h1>external-migration</h1>

<h1>Description</h1>
<p>External data migration provides a means for rarely accessed files to be moved off primary storage onto a lower cost long term storage server. The original files in the server's file system are replaced with remote Cross Volume Links (CVL).</p>
<p>CIFS, NFS and other clients of the server can continue to access externally migrated files transparently: any access to a CVL will be converted to a client protocol request to the external storage server.</p>
<p>A related form of data migration is available to migrate files between different file systems in the same EVS.  This document will not describe this local form of data migration, though many of the concepts are similar.</p>
<h2>Migration Paths</h2>
<p>In order to migrate files from a file system, a <strong>migration path</strong> must be created. The migration path defines the linkage between a local file system and one or more <em>migration targets</em>.  When a migration path is configured with multiple targets the system will attempt to balance the load across all of the targets; in the case of external migration this is done by a simple round-robin.</p>
<h3>Migration Targets</h3>
<p>A <strong>migration target</strong> is the definition of a single destination to which files may be migrated. A migration target uniquely specifies the target server, any pathname from the root of the target, the protocol to be used, and optional behaviour.</p>
<h3>Example</h3>
<p>To create a migration path and add the first target to it, use the <code>migration-add-external-path</code> command. In this example a target called "first-target" is created on file system "fs0" to an NFS server "nfs.example.com" and an NFS export called "/archive":</p>
<pre>$ migration-add-external-path -s fs0 -n first-target -t nfs://nfs.example.com/archive
</pre>
<p></p>
<h2>Target Pathnames</h2>
<p>All filenames on the target server are appended with a version number suffix. The version number is based on the time at which the file is migrated. Thus a local file:</p>

<p>file.txt</p>

<p>would be renamed on the target:</p>

<p>file.txt.12345678</p>

<p>The target pathname of the file on the external storage server will be based on the pathname from which the file was migrated. So for instance a local file:</p>

<p>Span0FS:/user/fred/file.txt</p>

<p>which was migrated to an NFS external migration target, nfs.example.com:/archive, might result in a target path of:</p>

<p>nfs.example.com:/archive/user/fred/file.txt.12345678</p>

<p>The target pathname is calculated at the time that the file is first migrated. If the local file (now a CVL) is later renamed or moved to another directory, that change <strong>will not</strong> be reflected on the target server.</p>
<h2>Supported Protocols</h2>
<p>The following data access protocols are supported for external data migration:</p>
<pre>    HTTP
    NFS v3
</pre>
<p></p>
<p>The options that each protocol supports and the exact target syntax to be used is described in the man page for <code>migration-add-external-path</code>.</p>
<h2>External Migration Control</h2>
<p>The SMU has the ability to configure and control data migration based on rules, policies and schedules.</p>
<p>A data migration <strong>rule</strong> specifies which files should be selected from the source file system.</p>
<p>A data migration <strong>policy</strong> specifies which rule(s) to apply to which data migration path (which is itself tied to a source file system).</p>
<p>A data migration <strong>schedule</strong> specifies that a policy should be run at a specified time with various options. Two options have particular relevance:</p>

<dl>
<dt><strong>Test only</strong></dt>
<dd><p>Causes a policy to be run once and report on which files would be migrated, but does not actually perform the migration.</p></dd>
<dt><strong>Report</strong></dt>
<dd><p>Causes a policy to be run once and report on which files have already been migrated, and where those source files refer to on the target.</p></dd>
</dl>

<h2>Third Party Integrations</h2>
<p>Most NFS v3 servers can be used as external migration targets.</p>
<p>A restricted number of third party storage products are supported by HTTP external migration, including:</p>
<dl>
<dt><strong>Hitachi Content Archive Platform 2.x,</strong></dt>
<dt><strong>Hitachi Content Platform 3.x</strong></dt>
<dd><p>The Hitachi Content Platform is a virtualized distributed object store designed for long term unstructured data storage.</p></dd>
<dt><strong>Atempo Digital Archive</strong></dt>
<dd><p>The Atempo Digital Archive is an enterprise-level long-term archiving solution for business-critical data. An Atempo migration target <strong>must</strong> be configured using the <strong>--type external-control</strong> option to <code>migration-add-external-path</code>.</p></dd>
</dl>
<p>For the full list of supported external migration and archival systems see the Administration Guide and Release Notes.</p>
<h2>Troubleshooting</h2>
<p>The following commands will help when investigating external migration problems.</p>
<dl>
<dt><strong>trouble</strong></dt>
<dd><p>The trouble command will display connection issues to migration targets, and migration path configuration problems.</p></dd>
<dt><strong>remote-mount-errors</strong></dt>
<dt><strong>remote-nfs-errors</strong></dt>
<dt><strong>remote-nfs-perf</strong></dt>
<dt><strong>remote-nfs-stats</strong></dt>
<dd><p>These commands display low level NFS client errors and statistics.</p></dd>
<dt><strong>remote-cvl-nfs-errors</strong></dt>
<dt><strong>remote-cvl-nfs-stats</strong></dt>
<dd><p>These commands display cross volume link errors and statistics for NFS migration targets.</p></dd>
<dt><strong>remote-http-errors</strong></dt>
<dt><strong>remote-http-stats</strong></dt>
<dd><p>This command displays low level HTTP client errors.</p></dd>
<dt><strong>remote-cvl-http-errors</strong></dt>
<dt><strong>remote-cvl-http-perf</strong></dt>
<dt><strong>remote-cvl-http-stats</strong></dt>
<dd><p>These commands displays cross volume link errors and statistics for HTTP migration targets.</p></dd>
</dl>
<h1>See Also</h1>
<p><a href="../Supervisor/migration-add-external-path.html">migration-add-external-path</a> <a href="../Supervisor/migration-change-external-path.html">migration-change-external-path</a> <a href="../Supervisor/migration-delete-external-path.html">migration-delete-external-path</a> <a href="../Supervisor/migration-expand-external-path.html">migration-expand-external-path</a> <a href="../Supervisor/migration-list-paths.html">migration-list-paths</a> <a href="../Supervisor/remote-cvl-http-errors.html">remote-cvl-http-errors</a> <a href="../Supervisor/remote-cvl-http-perf.html">remote-cvl-http-perf</a> <a href="../Supervisor/remote-cvl-http-stats.html">remote-cvl-http-stats</a> <a href="../Supervisor/remote-cvl-nfs-errors.html">remote-cvl-nfs-errors</a> <a href="../Supervisor/remote-cvl-nfs-stats.html">remote-cvl-nfs-stats</a> <a href="../Supervisor/remote-http-errors.html">remote-http-errors</a> <a href="../Dev/remote-http-stats.html">remote-http-stats</a> <a href="../Supervisor/remote-mount-errors.html">remote-mount-errors</a> <a href="../Supervisor/remote-nfs-errors.html">remote-nfs-errors</a> <a href="../Dev/remote-nfs-perf.html">remote-nfs-perf</a> <a href="../Dev/remote-nfs-stats.html">remote-nfs-stats</a></p>
<h1>Privilege Level</h1>
<p>Topic</p>
<blockquote></blockquote>
<!--End footer-->
</body>
</html>
