<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>check-directory</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
  <!--
  @page { size: 8.27in 11.69in }
  H1  { font-family: "Verdana", sans-serif }
  H2  { font-family: "Verdana", sans-serif }
  H3  { font-family: "Verdana", sans-serif }
  H4  { font-family: "Verdana", sans-serif }
  P   { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  PRE { font-family: "Courier", monospace;  font-size: 12pt; margin-left: 40px; }
  DT  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  LI  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  -->
  </style>

</head>
<body style="background-color: white">
<!--Start header -->
<!-- html created: 2023-03-07 12:50:50 +0000 oemId: 1 -->
<h1>check-directory</h1>
<p>Schedules a check of a directory on the specified file system</p>
<h1>Syntax</h1>
<pre>check-directory  [--terse] [--recursive] [--check-entries] [--abort] (-o &lt;object-number&gt; | -d &lt;directory-path&gt;) &lt;file-system&gt;
</pre>

<h1>Description</h1>
<p>When run without any optional arguments, check-directory will check the integrity of a directory (internally, the WDIR and WTREE metadata structures).</p>
<p>When run with the -e (check-Entries) option, in addition to checking the directory metadata, all the directory entries contained in the specified directory are also checked.</p>
<p>When run with the -r (Recursive) option, as well as checking the specified directory, check-directory will check all the entries and recurse down the directory tree checking all objects that it comes across. Using this option while supplying the root directory as the target, causes check-directory to do a very similar file system integrity check to that performed by checkfs. check-directory, however, does not perform checks on the format files; it does not verify the integrity of the FSA bitmap, but it does check for under-allocations for file system objects, however, cross-linked blocks and over-allocations will not be detected; it does not check the freed blocks lists or the free root onode lists; it does not verify hard-link counts for files, nor does it check that Security Descriptor reference counts are correct. Lastly, you cannot make check-directory perform the duplicate hash key check on a WTREE object as you can with checkfs.</p>
<p>Progress reporting for check-directory is inferior to that for checkfs. Because checkfs knows that it is checking the entire file system, a progress percentage can be calculated for most of the checkfs phases. However, since check-directory may be run on any directory, it has no idea how much work lies ahead, and therefore cannot measure how much work there is to do before it completes.</p>
<p>As with checkfs, there is no means of checking user data.</p>
<p>If there is any doubt regarding the integrity of the underlying storage layer, then a recursive check-directory from the root directory should always be preferred to running checkfs. This is because checkfs writes to the scratch space located at the end of the file system, and cannot be considered read-only. However, if confidence in the storage is very high and a full check is required, the checkfs is the tool to use for completeness.</p>
<p>check-directory may be run on an unmounted file system, even if it was not unmounted cleanly. check-directory may also be run on a file system that is currently mounted and serving files.</p>
<p>On mounted WFS-2 file-systems, check-directory creates an internal snapshot to perform the check, and removes it at the end of the run.</p>
<p>check-directory is an asynchronous utility.</p>
<p>Consult the event log to see the results of the check, or for a more detailed analysis consult the dynamic log.</p>
<p>Options:</p>
<dl>
<dt><strong>--object-number, -o &lt;object-number&gt;</strong></dt>
<dd><p>The object number of the directory</p></dd>
<dt><strong>--directory-path, -d &lt;directory-path&gt;</strong></dt>
<dd><p>The full path of the directory</p></dd>
<dt><strong>--terse, -t</strong></dt>
<dd><p>Terse output</p></dd>
<dt><strong>--check-entries, -e</strong></dt>
<dd><p>Check entries</p></dd>
<dt><strong>--recursive, -r</strong></dt>
<dd><p>Recursive check entries</p></dd>
<dt><strong>--abort, -a</strong></dt>
<dd><p>Abort an existing check</p></dd>
</dl>
<h1>Examples</h1>
<p>To perform a recursive check from the root directory on file system fs1:</p>
<pre>check-directory -r -d / fs1
</pre>
<p></p>
<p>To check the directory whose object number is 0x2c0 on file system fs2:</p>
<pre>check-directory -o 0x2c0 fs2
</pre>
<p></p>
<p>To check the directory /myDir and its directory entries on file system fs2:</p>
<pre>check-directory -d /myDir -e fs2
</pre>
<p></p>
<h1>Applies To</h1>
<p>EVS</p>
<h1>See Also</h1>
<p><a href="../Supervisor/check-objstore.html">check-objstore</a> <a href="../Supervisor/checkfs.html">checkfs</a> <a href="../Supervisor/dynamic-log-dump.html">dynamic-log-dump</a> <a href="../Supervisor/utility-progress.html">utility-progress</a></p>
<h1>Privilege Level</h1>
<p>Supervisor</p>
<blockquote></blockquote>
<!--End footer-->
</body>
</html>
