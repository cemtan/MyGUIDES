<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>umask-file-set</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
  <!--
  @page { size: 8.27in 11.69in }
  H1  { font-family: "Verdana", sans-serif }
  H2  { font-family: "Verdana", sans-serif }
  H3  { font-family: "Verdana", sans-serif }
  H4  { font-family: "Verdana", sans-serif }
  P   { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  PRE { font-family: "Courier", monospace;  font-size: 12pt; margin-left: 40px; }
  DT  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  LI  { font-family: "Verdana", sans-serif; font-size: 11pt; margin-left: 40px; }
  -->
  </style>

</head>
<body style="background-color: white">
<!--Start header -->
<!-- html created: 2023-03-07 12:50:50 +0000 oemId: 1 -->
<h1>umask-file-set</h1>
<p>Set the umask for file creation</p>
<h1>Syntax</h1>
<pre>umask-file-set &lt;octal umask 0..0777&gt;
</pre>

<h1>Description</h1>
<p>The umask- commands, in combination with the CIFS share configuration options described below, manage the umasks for file and directory creation.</p>
<dl>
<dt><strong>umask-file-show</strong></dt>
<dd><p>Displays the umask for file creation</p></dd>
<dt><strong>umask-directory-show</strong></dt>
<dd><p>Displays the umask for directory creation</p></dd>
<dt><strong>umask-file-set &lt;octal umask 0..0777&gt;</strong></dt>
<dd><p>Set the umask for file creation</p></dd>
<dt><strong>umask-directory-set &lt;octal umask 0..0777&gt;</strong></dt>
<dd><p>Set the umask for directory creation</p></dd>
</dl>
<p>As with the UNIX umask system call, the umask specifies the bits which should be cleared from the default mode, which is taken as 0777.  If the three active octal digits are labeled 0ugo, then they specify the mode for (u)ser, (g)roup and (o)thers respectively. Each octal digit is a bitmask of 4 for read, 2 for write and 1 for execute permission (ie rwx from most to least significant bit).</p>
<p>The above commands are used to manage the file and directory umasks across the current EVS security context (cluster-wide or per-EVS). umasks can also be configured per CIFS share. To achieve this, the following text can be added to the access qualifiers in the share's access configuration options:</p>
<pre>  file_umask=&lt;octal mask 0..0777&gt;
  directory_umask=&lt;octal mask 0..0777&gt;
</pre>
<p></p>
<p>If configured, a per-share umask will be used in preference to any umask in the current EVS security context (cluster-wide or per-EVS).</p>
<p>These umasks are only used for creations in directories without inheritable security, and only when the creation doesn't explicitly set the new object's security.  It's generally CIFS creates that fall into this category, although NFS and on-the-box CLI creates with the "passthrough" behavior of fs-dacl-mode and FTP creates may also use them. The interaction of fs-dacl-mode's passthrough and non-default setting of umask-file-set can cause symlinks to be created with a mode other than 0777. This will potentially stop them from working for other users. It is for this reason that the CIFS share file_umask setting is recommended instead of the cross-protocol umask-file-set command.</p>
<p>Directories usually have inheritable security when the parent directory's security (or an ancestor directory's) was set with CIFS.  The main circumstance when these umasks come into play is when CIFS creates a file or directory inside a directory whose security was last set via NFS with the "discard" behavior of fs-dacl-mode. In the default fs-dacl-mode, this means directories created via NFS. Most on-the-box directory creations, for example when creating virtual-volumes, use NFS-style security. In the default fs-dacl-mode, NFS chmod does not discard inheritable security. (This is a change with the advent of fs-dacl-mode in 6.0.)</p>
<p>FTP doesn't supply any security-related details to the file system when creating files and directories, so the global umask settings are picked up, as for CIFS.</p>
<p>There are no per-mount point umasks for NFS or FTP.</p>
<h1>Examples</h1>
<pre>server:$ umask-file-show
the default, shared security context: 0000
server:$ evs-select 3
server:$ umask-directory-show
the default, shared security context (via EVS 3): 0000
server:$
</pre>
<p></p>
<p>To achieve u=rwx,g=rwx,o=rx:</p>
<pre>server:$ umask-file-set 2
the default, shared security context: 0002
This non-zero file umask may lead to unconventional symlink security in the presence of a passthrough fs-dacl-mode.
server:$ umask-directory-set 2
the default, shared security context: 0002
server:$
</pre>
<p></p>
<p>To achieve u=rwx,g=rx,o=rx:</p>
<pre>server:$ umask-file-set 022
the default, shared security context: 0022
This non-zero file umask may lead to unconventional symlink security in the presence of a passthrough fs-dacl-mode.
server:$ umask-directory-set 022
the default, shared security context: 0022
server:$
</pre>
<p></p>
<h1>Applies To</h1>
<p>EVS security context</p>
<h1>See Also</h1>
<p><a href="../Supervisor/cacls-add.html">cacls-add</a> <a href="../Supervisor/cacls-del.html">cacls-del</a> <a href="../Supervisor/cacls-mask-in.html">cacls-mask-in</a> <a href="../Supervisor/cacls-mask-out.html">cacls-mask-out</a> <a href="../Supervisor/cacls-set.html">cacls-set</a> <a href="../Supervisor/chgrp.html">chgrp</a> <a href="../Supervisor/chmod.html">chmod</a> <a href="../Supervisor/chown.html">chown</a> <a href="../User/cifs-share.html">cifs-share</a> <a href="../Supervisor/fs-dacl-mode.html">fs-dacl-mode</a> <a href="../Supervisor/ls.html">ls</a> <a href="../Supervisor/security-decode-file.html">security-decode-file</a> <a href="../Supervisor/umask-directory-set.html">umask-directory-set</a> <a href="../User/umask-directory-show.html">umask-directory-show</a> <a href="../User/umask-file-show.html">umask-file-show</a></p>
<h1>Privilege Level</h1>
<p>Supervisor</p>
<blockquote></blockquote>
<!--End footer-->
</body>
</html>
